import { readFileSync } from "fs";
const { SAML } = require("node-saml");

export default new SAML({
  entryPoint: "https://testi.apro.tunnistus.fi/idp/profile/SAML2/Redirect/SSO",
  callbackUrl: "https://q88uo5prmh.execute-api.eu-north-1.amazonaws.com/auth/saml2/authenticate-response",
  logoutUrl: "https://testi.apro.tunnistus.fi/idp/profile/SAML2/Redirect/SLO",
  logoutCallbackUrl: "https://q88uo5prmh.execute-api.eu-north-1.amazonaws.com/auth/saml2/logout",
  issuer: "https://q88uo5prmh.execute-api.eu-north-1.amazonaws.com",
  signMetadata: true,
  signatureAlgorithm: "sha256",
  digestAlgorithm: "sha256",
  privateKey: readFileSync("./certificates/virtual_finland_development.key", "utf-8"),
  cert: [
    "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",
  ],
  decryptionPvk: readFileSync("./certificates/virtual_finland_development.key", "utf-8"),
  wantAssertionsSigned: true,
  wantAuthnResponseSigned: true,
  //idpIssuer: "https://testi.apro.tunnistus.fi/static/metadata/idp-metadata.xml",
  samlAuthnRequestExtensions: {
    vetuma: {
      "@xmlns": "urn:vetuma:SAML:2.0:extensions",
      LG: {
        "#text": "fi",
      },
    },
  },
  disableRequestedAuthnContext: true,
  identifierFormat: null,
});
